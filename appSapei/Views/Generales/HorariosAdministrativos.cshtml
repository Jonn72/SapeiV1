<input type="hidden" id="txtID" value="@ViewData["ID"]" />

<div class="page-title">
    <div class="title_left">
        <h3>Horario <small>Administrativo</small></h3>
    </div>
</div>
<div class="clearfix"></div>
@Html.Partial("../Generales/TablaGeneral")


@Html.Partial("../Generales/ModalVisorPDF")
@Html.Partial("../Generales/FirmaElectronica")


<script type="text/javascript">
    orden(4, "desc");

    ocultar_buscar();
    function displaySection() {
        $('#divModalVisorPDF').modal('show');
        $("#divCargando").hide();
        $("#divPDF").show();
        $('#divModalFirmaElectronica').modal('hide');
    }

    function vistaHorario(ID) {
        $("#divCargando").show();
        $("#divPDF").hide();
        $('#divPDF').load('../../../../Reportes/HorarioRecontratacionPDF?psID=' + ID, displaySection);
        event.preventDefault();
    }

    function vistaHorarioFacilitador(ID) {
        $("#divCargando").show();
        $("#divPDF").hide();
        $('#divPDF').load('../../../../Reportes/HorarioRecontratacionFacilitadorPDF?psID=' + ID, displaySection);
        event.preventDefault();
    }

    function PreparaFirma(ID) {
        $("#txtID").val(ID);
        $('#divModalFirmaElectronica').modal('show');
    }

    $("#btnEnviarFirmar").click(function () {
        var firma = $("#txtFirma").val();
        var ID = $("#txtID").val();
        var Status = "3";
        $('#divModalFirmaElectronica').modal('hide');

        $.ajax({
            asyn: false,
            url: '../../../Generales/FirmaHorarioPersonal',
            type: 'POST',
            dataType: 'json',
            data: { psFirma: firma, psID: ID, psStatus: Status },
        })
            .done(function (data) {

                if (typeof (data.Success) === "undefined" || !data.Success) {
                    MensajesToastr("error", "Solicitud Procesada", "Error al Guardar");
                }
                else {
                    MensajesToastr("success", "Solicitud Procesada", "Registro Correcto");

                    $('.modal-backdrop').remove();
                    $('#BodyPrincipal').load('../../../../Generales/HorariosAdministrativos');
                }
            })
            .fail(function (data) {
                MensajesToastrErrorConexion();
            }).always(function () {
            });
        event.preventDefault();
    });
</script>

